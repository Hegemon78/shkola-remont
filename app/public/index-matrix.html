<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–í–®–† ‚Äî –ú–∞—Ç—Ä–∏—Ü–∞ –±–ª–æ–∫–æ–≤</title>
  <style>
    :root {
      --bg: #0d1117;
      --bg-card: #161b22;
      --bg-hover: #21262d;
      --border: #30363d;
      --text: #c9d1d9;
      --text-muted: #8b949e;
      --accent: #58a6ff;
      --green: #3fb950;
      --yellow: #d29922;
      --red: #f85149;
      --purple: #a371f7;
      --orange: #f0883e;
      --pink: #db61a2;
      --cyan: #39c5cf;

      --block-system: #8b949e;
      --block-prep: #f85149;
      --block-comm: #58a6ff;
      --block-construct: #a371f7;
      --block-floors: #f0883e;
      --block-finish: #3fb950;
      --block-doors: #db61a2;
      --block-facade: #39c5cf;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      min-height: 100vh;
    }

    .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

    /* Sticky Navigation */
    .top-nav {
      position: sticky;
      top: 0;
      background: var(--bg);
      border-bottom: 1px solid var(--border);
      z-index: 100;
      padding: 12px 20px;
    }

    .nav-container {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .nav-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 8px;
      transition: background 0.2s;
    }

    .nav-logo:hover { background: var(--bg-hover); }
    .nav-logo-icon { font-size: 24px; }
    .nav-logo-text { font-weight: 700; font-size: 16px; color: var(--accent); }

    .nav-breadcrumb {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
      overflow: hidden;
    }

    .nav-crumb {
      color: var(--text-muted);
      font-size: 13px;
      white-space: nowrap;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      transition: all 0.2s;
    }

    .nav-crumb:hover { color: var(--text); background: var(--bg-hover); }
    .nav-crumb.active { color: var(--text); font-weight: 500; }
    .nav-crumb-sep { color: var(--text-muted); font-size: 12px; }

    .nav-actions { display: flex; align-items: center; gap: 12px; }

    .search-box-nav {
      display: flex;
      align-items: center;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 12px;
      width: 200px;
    }

    .search-box-nav input {
      background: none;
      border: none;
      color: var(--text);
      font-size: 13px;
      width: 100%;
      outline: none;
    }

    /* Compact Stats Bar */
    .stats-bar {
      display: flex;
      align-items: center;
      gap: 24px;
      padding: 16px 24px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .stats-bar-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--accent);
    }

    .stats-bar-items { display: flex; gap: 20px; flex: 1; flex-wrap: wrap; }

    .stats-item { display: flex; align-items: center; gap: 6px; }
    .stats-item-value { font-size: 22px; font-weight: 700; }
    .stats-item-label { font-size: 11px; color: var(--text-muted); }

    .stats-item:nth-child(1) .stats-item-value { color: var(--accent); }
    .stats-item:nth-child(2) .stats-item-value { color: var(--green); }
    .stats-item:nth-child(3) .stats-item-value { color: var(--yellow); }
    .stats-item:nth-child(4) .stats-item-value { color: var(--text-muted); }

    .stats-progress {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .stats-progress-bar {
      width: 120px;
      height: 8px;
      background: var(--bg);
      border-radius: 4px;
      overflow: hidden;
    }

    .stats-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--green), var(--accent));
      border-radius: 4px;
    }

    .stats-progress-label { font-size: 14px; font-weight: 600; }

    /* Alerts Section */
    .alerts-section { margin-bottom: 16px; }

    .alert {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      background: rgba(248, 81, 73, 0.1);
      border: 1px solid rgba(248, 81, 73, 0.3);
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .alert-icon { font-size: 16px; }
    .alert-text { flex: 1; font-size: 13px; color: var(--text-muted); }
    .alert-text strong { color: var(--text); }
    .alert-link { color: var(--accent); cursor: pointer; font-size: 13px; }
    .alert-link:hover { text-decoration: underline; }

    /* Filter Bar */
    .filter-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filter-tabs {
      display: flex;
      gap: 4px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 4px;
    }

    .filter-tab {
      padding: 8px 16px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 13px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .filter-tab:hover { background: var(--bg-hover); color: var(--text); }
    .filter-tab.active { background: var(--accent); color: #000; font-weight: 500; }

    .filter-status { display: flex; gap: 8px; }

    .status-btn {
      padding: 6px 12px;
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text-muted);
      font-size: 12px;
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .status-btn:hover { border-color: var(--accent); color: var(--text); }
    .status-btn.active { background: var(--accent); border-color: var(--accent); color: #000; }

    /* Matrix Container */
    .matrix-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    @media (max-width: 900px) { .matrix-container { grid-template-columns: 1fr; } }

    .matrix-column {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }

    .matrix-header {
      padding: 14px 20px;
      border-bottom: 3px solid var(--border);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .matrix-header.—á–µ—Ä–Ω–æ–≤–∞—è { border-color: var(--yellow); background: rgba(210, 153, 34, 0.1); }
    .matrix-header.—á–∏—Å—Ç–æ–≤–∞—è { border-color: var(--green); background: rgba(63, 185, 80, 0.1); }

    .matrix-header-icon { font-size: 20px; }
    .matrix-header-title { font-size: 15px; font-weight: 600; }
    .matrix-header-count {
      margin-left: auto;
      font-size: 11px;
      color: var(--text-muted);
      background: var(--bg-hover);
      padding: 4px 10px;
      border-radius: 10px;
    }

    .matrix-blocks { padding: 12px; }

    /* Block Card */
    .block-card {
      background: var(--bg-hover);
      border: 1px solid var(--border);
      border-radius: 8px;
      margin-bottom: 10px;
      overflow: hidden;
    }

    .block-card:last-child { margin-bottom: 0; }

    .block-card-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 14px;
      cursor: pointer;
      transition: background 0.2s;
      border-left: 3px solid transparent;
    }

    .block-card-header:hover { background: var(--bg-card); }

    .block-card.block-system .block-card-header { border-left-color: var(--block-system); }
    .block-card.block-prep .block-card-header { border-left-color: var(--block-prep); }
    .block-card.block-comm .block-card-header { border-left-color: var(--block-comm); }
    .block-card.block-construct .block-card-header { border-left-color: var(--block-construct); }
    .block-card.block-floors .block-card-header { border-left-color: var(--block-floors); }
    .block-card.block-finish .block-card-header { border-left-color: var(--block-finish); }
    .block-card.block-doors .block-card-header { border-left-color: var(--block-doors); }
    .block-card.block-facade .block-card-header { border-left-color: var(--block-facade); }

    .block-card-icon { font-size: 18px; }
    .block-card-title { font-weight: 600; font-size: 13px; flex: 1; }

    .block-card-stats { display: flex; gap: 10px; align-items: center; }

    .block-progress {
      width: 50px;
      height: 5px;
      background: var(--bg);
      border-radius: 3px;
      overflow: hidden;
    }

    .block-progress-fill { height: 100%; background: var(--green); border-radius: 3px; }

    .block-card-count { font-size: 11px; color: var(--text-muted); }
    .block-card-toggle { font-size: 10px; color: var(--text-muted); transition: transform 0.2s; }

    .block-card.collapsed .block-card-toggle { transform: rotate(-90deg); }
    .block-card.collapsed .block-card-content { display: none; }

    .block-card-content { padding: 0 14px 12px; }

    /* Direction Row */
    .direction-row {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 10px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 6px;
      margin-bottom: 4px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .direction-row:last-child { margin-bottom: 0; }
    .direction-row:hover { border-color: var(--accent); background: var(--bg-hover); }
    .direction-row.hidden { display: none; }

    .row-icon { font-size: 16px; }
    .row-id { font-family: monospace; font-size: 10px; color: var(--text-muted); }
    .row-name { flex: 1; font-size: 12px; font-weight: 500; }

    .row-progress { display: flex; align-items: center; gap: 6px; }

    .progress-bar-mini {
      width: 40px;
      height: 4px;
      background: var(--bg);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-bar-mini .fill { height: 100%; background: var(--green); border-radius: 2px; }
    .row-tech-count { font-size: 11px; color: var(--text-muted); min-width: 35px; text-align: right; }
    .row-tech-count strong { color: var(--text); }

    /* No Results */
    .no-results { text-align: center; padding: 60px 20px; color: var(--text-muted); }
    .no-results h3 { margin-bottom: 8px; }

    /* Footer */
    footer {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-muted);
      font-size: 13px;
      border-top: 1px solid var(--border);
      margin-top: 40px;
    }

    /* Direction View */
    .direction-view { display: none; }
    .direction-view.active { display: block; }

    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: var(--accent);
      font-size: 14px;
      cursor: pointer;
      margin-bottom: 20px;
      padding: 8px 0;
    }
    .back-btn:hover { text-decoration: underline; }

    .direction-header {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 28px;
      margin-bottom: 24px;
      position: relative;
      overflow: hidden;
    }

    .direction-header::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 4px;
    }

    .direction-header.block-system::before { background: var(--block-system); }
    .direction-header.block-prep::before { background: var(--block-prep); }
    .direction-header.block-comm::before { background: var(--block-comm); }
    .direction-header.block-construct::before { background: var(--block-construct); }
    .direction-header.block-floors::before { background: var(--block-floors); }
    .direction-header.block-finish::before { background: var(--block-finish); }
    .direction-header.block-doors::before { background: var(--block-doors); }
    .direction-header.block-facade::before { background: var(--block-facade); }

    .direction-icon { font-size: 48px; margin-bottom: 12px; }
    .direction-title { font-size: 28px; margin-bottom: 8px; }

    .direction-meta {
      display: flex;
      gap: 16px;
      color: var(--text-muted);
      font-size: 14px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .direction-deps { display: flex; gap: 32px; flex-wrap: wrap; }

    .dep-group h4 {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .dep-tags { display: flex; gap: 8px; flex-wrap: wrap; }

    .dep-tag {
      background: var(--bg-hover);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .dep-tag:hover { border-color: var(--accent); color: var(--accent); }
    .dep-tag.requires { border-left: 3px solid var(--yellow); }
    .dep-tag.opens { border-left: 3px solid var(--green); }

    /* Stage Section */
    .stage-section { margin-bottom: 28px; }

    .stage-title {
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-muted);
      margin-bottom: 16px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--border);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .stage-title.—á–µ—Ä–Ω–æ–≤–∞—è { border-color: var(--yellow); }
    .stage-title.—á–∏—Å—Ç–æ–≤–∞—è { border-color: var(--green); }

    .stage-title .count {
      margin-left: auto;
      background: var(--bg-hover);
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
    }

    .stage-badge {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 10px;
    }

    .stage-badge.—á–µ—Ä–Ω–æ–≤–∞—è { background: rgba(210, 153, 34, 0.2); color: var(--yellow); }
    .stage-badge.—á–∏—Å—Ç–æ–≤–∞—è { background: rgba(63, 185, 80, 0.2); color: var(--green); }

    /* Tech List */
    .tech-list { display: flex; flex-direction: column; gap: 8px; }

    .tech-item {
      display: flex;
      align-items: center;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 16px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tech-item:hover { border-color: var(--accent); background: var(--bg-hover); }

    .tech-id {
      font-family: monospace;
      font-size: 11px;
      color: var(--text-muted);
      background: var(--bg-hover);
      padding: 4px 10px;
      border-radius: 4px;
      margin-right: 14px;
      min-width: 80px;
      text-align: center;
    }

    .tech-name { flex: 1; font-size: 14px; }
    .tech-meta { display: flex; gap: 12px; align-items: center; }
    .tech-difficulty { display: flex; gap: 3px; }
    .tech-difficulty span { width: 6px; height: 6px; border-radius: 50%; background: var(--border); }
    .tech-difficulty span.filled { background: var(--accent); }

    .tech-status {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 10px;
      font-weight: 500;
    }

    .tech-status.draft { background: rgba(139, 148, 158, 0.2); color: var(--text-muted); }
    .tech-status.review { background: rgba(210, 153, 34, 0.2); color: var(--yellow); }
    .tech-status.approved { background: rgba(63, 185, 80, 0.2); color: var(--green); }

    /* Technology View */
    .tech-view { display: none; }
    .tech-view.active { display: block; }

    .tech-page {
      display: grid;
      grid-template-columns: 260px 1fr;
      gap: 24px;
      align-items: start;
    }

    @media (max-width: 1000px) {
      .tech-page { grid-template-columns: 1fr; }
      .tech-sidebar { position: static !important; }
    }

    .tech-sidebar { position: sticky; top: 80px; }

    .tech-sidebar-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .tech-sidebar-title {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .tech-toc { list-style: none; }
    .tech-toc li { margin-bottom: 6px; }

    .tech-toc a {
      display: block;
      padding: 6px 10px;
      color: var(--text-muted);
      text-decoration: none;
      border-radius: 6px;
      font-size: 12px;
      transition: all 0.2s;
      border-left: 2px solid transparent;
    }

    .tech-toc a:hover {
      background: var(--bg-hover);
      color: var(--text);
      border-left-color: var(--accent);
    }

    .tech-main { min-width: 0; }

    .tech-header {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
    }

    .tech-header::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 4px;
    }

    .tech-header.block-system::before { background: var(--block-system); }
    .tech-header.block-prep::before { background: var(--block-prep); }
    .tech-header.block-comm::before { background: var(--block-comm); }
    .tech-header.block-construct::before { background: var(--block-construct); }
    .tech-header.block-floors::before { background: var(--block-floors); }
    .tech-header.block-finish::before { background: var(--block-finish); }
    .tech-header.block-doors::before { background: var(--block-doors); }
    .tech-header.block-facade::before { background: var(--block-facade); }

    .tech-breadcrumb {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 14px;
    }

    .tech-breadcrumb a { color: var(--accent); text-decoration: none; }
    .tech-breadcrumb a:hover { text-decoration: underline; }

    .tech-title-row {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      margin-bottom: 14px;
    }

    .tech-icon { font-size: 40px; flex-shrink: 0; }
    .tech-title-content { flex: 1; }
    .tech-title { font-size: 24px; font-weight: 600; margin-bottom: 6px; }
    .tech-description { color: var(--text-muted); font-size: 14px; line-height: 1.5; }

    .tech-badges { display: flex; flex-wrap: wrap; gap: 8px; align-items: center; }

    .tech-badge {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 12px;
      background: var(--bg-hover);
      color: var(--text-muted);
    }

    .tech-badge.stage { border: 1px solid; }
    .tech-badge.—á–µ—Ä–Ω–æ–≤–∞—è { background: rgba(210, 153, 34, 0.2); color: var(--yellow); border-color: var(--yellow); }
    .tech-badge.—á–∏—Å—Ç–æ–≤–∞—è { background: rgba(63, 185, 80, 0.2); color: var(--green); border-color: var(--green); }

    .tech-content {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
    }

    /* Markdown */
    .markdown-content h1 { font-size: 24px; margin: 0 0 16px 0; padding-bottom: 12px; border-bottom: 2px solid var(--border); }
    .markdown-content h2 { font-size: 18px; margin: 28px 0 14px 0; padding-bottom: 8px; border-bottom: 1px solid var(--border); color: var(--accent); }
    .markdown-content h3 { font-size: 15px; margin: 20px 0 10px 0; color: var(--text); }
    .markdown-content p { margin: 10px 0; line-height: 1.7; }
    .markdown-content ul, .markdown-content ol { margin: 10px 0; padding-left: 24px; }
    .markdown-content li { margin: 6px 0; line-height: 1.6; }
    .markdown-content code { background: var(--bg-hover); padding: 2px 6px; border-radius: 4px; font-family: monospace; font-size: 12px; }
    .markdown-content blockquote { border-left: 4px solid var(--accent); padding: 10px 14px; margin: 14px 0; color: var(--text-muted); background: var(--bg-hover); border-radius: 0 8px 8px 0; }
    .markdown-content table { width: 100%; border-collapse: collapse; margin: 14px 0; font-size: 13px; }
    .markdown-content th { background: var(--bg-card); border: 1px solid var(--border); padding: 10px; text-align: left; font-weight: 600; }
    .markdown-content td { border: 1px solid var(--border); padding: 8px 10px; }

    @media (max-width: 768px) {
      .stats-bar { flex-direction: column; align-items: flex-start; }
      .filter-bar { flex-direction: column; align-items: stretch; }
      .nav-logo-text { display: none; }
      .search-box-nav { width: 140px; }
      .nav-breadcrumb { display: none; }
    }
  </style>
</head>
<body>
  <nav class="top-nav">
    <div class="nav-container">
      <div class="nav-logo" onclick="showMainView()">
        <span class="nav-logo-icon">üèóÔ∏è</span>
        <span class="nav-logo-text">–í–®–†</span>
      </div>
      <div class="nav-breadcrumb" id="nav-breadcrumb">
        <span class="nav-crumb active">–ì–ª–∞–≤–Ω–∞—è</span>
      </div>
      <div class="nav-actions">
        <div class="search-box-nav">
          <input type="text" id="search" placeholder="üîç –ü–æ–∏—Å–∫...">
        </div>
      </div>
    </div>
  </nav>

  <div class="container">
    <div id="main-view">
      <div class="stats-bar" id="stats-bar"></div>
      <div class="alerts-section" id="alerts"></div>
      <div class="filter-bar">
        <div class="filter-tabs">
          <button class="filter-tab active" data-filter="all" onclick="setFilter('all')">–í—Å–µ</button>
          <button class="filter-tab" data-filter="—á–µ—Ä–Ω–æ–≤–∞—è" onclick="setFilter('—á–µ—Ä–Ω–æ–≤–∞—è')">–ß–µ—Ä–Ω–æ–≤–æ–π —ç—Ç–∞–ø</button>
          <button class="filter-tab" data-filter="—á–∏—Å—Ç–æ–≤–∞—è" onclick="setFilter('—á–∏—Å—Ç–æ–≤–∞—è')">–ß–∏—Å—Ç–æ–≤–æ–π —ç—Ç–∞–ø</button>
        </div>
        <div class="filter-status">
          <button class="status-btn active" data-status="all" onclick="setStatusFilter('all')">–í—Å–µ</button>
          <button class="status-btn" data-status="draft" onclick="setStatusFilter('draft')">–ß–µ—Ä–Ω–æ–≤–∏–∫–∏</button>
          <button class="status-btn" data-status="review" onclick="setStatusFilter('review')">–ü—Ä–æ–≤–µ—Ä–∫–∞</button>
          <button class="status-btn" data-status="approved" onclick="setStatusFilter('approved')">–ì–æ—Ç–æ–≤–æ</button>
        </div>
      </div>
      <div class="matrix-container" id="matrix-container"></div>
      <div class="no-results" id="no-results" style="display: none;">
        <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>
      </div>
    </div>

    <div id="direction-view" class="direction-view">
      <div class="back-btn" onclick="showMainView()">‚Üê –í—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
      <div id="direction-content"></div>
    </div>

    <div id="tech-view" class="tech-view">
      <div class="back-btn" id="tech-back-btn">‚Üê –ù–∞–∑–∞–¥</div>
      <div class="tech-page">
        <div class="tech-sidebar">
          <div class="tech-sidebar-card">
            <div class="tech-sidebar-title">üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</div>
            <ul class="tech-toc" id="tech-toc"></ul>
          </div>
        </div>
        <div class="tech-main">
          <div id="tech-header-container"></div>
          <div class="tech-content">
            <div class="markdown-content" id="tech-content"></div>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –®–∫–æ–ª–∞ –†–µ–º–æ–Ω—Ç–∞</p>
      <p>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: <span id="generated-date"></span></p>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <script>
    let DATA = null;
    let currentFilter = 'all';
    let currentStatusFilter = 'all';
    let searchQuery = '';

    const DIRECTION_ICONS = {
      'D00': 'üìã', 'D01': 'üî®', 'D02': '‚ö°', 'D03': 'üì°', 'D04': 'üîß',
      'D05': '‚ùÑÔ∏è', 'D06': 'üß±', 'D07': 'üõ°Ô∏è', 'D08': 'üéØ', 'D09': 'ü™£',
      'D10': 'üé®', 'D11': 'üìú', 'D12': 'üî≤', 'D13': 'üìê', 'D14': 'ü™µ',
      'D15': 'ü™ü', 'D16': 'üö™', 'D17': 'üö™', 'D18': 'üè†'
    };

    const BLOCK_CLASSES = {
      '–°–∏—Å—Ç–µ–º–Ω–æ–µ': 'block-system', '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞': 'block-prep',
      '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏': 'block-comm', '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤': 'block-construct',
      '–ü–æ–ª—ã': 'block-floors', '–û—Ç–¥–µ–ª–∫–∞': 'block-finish',
      '–î–≤–µ—Ä–∏/–û–∫–Ω–∞': 'block-doors', '–§–∞—Å–∞–¥': 'block-facade'
    };

    const BLOCK_INFO = {
      '–°–∏—Å—Ç–µ–º–Ω–æ–µ': { icon: 'üìã', title: '–°–∏—Å—Ç–µ–º–Ω–æ–µ', order: 0 },
      '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞': { icon: 'üî®', title: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞', order: 1 },
      '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏': { icon: '‚ö°', title: '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏', order: 2 },
      '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤': { icon: 'üß±', title: '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤', order: 3 },
      '–ü–æ–ª—ã': { icon: 'üìê', title: '–ü–æ–ª—ã', order: 4 },
      '–û—Ç–¥–µ–ª–∫–∞': { icon: 'üé®', title: '–û—Ç–¥–µ–ª–∫–∞', order: 5 },
      '–î–≤–µ—Ä–∏/–û–∫–Ω–∞': { icon: 'üö™', title: '–î–≤–µ—Ä–∏ –∏ –æ–∫–Ω–∞', order: 6 },
      '–§–∞—Å–∞–¥': { icon: 'üè†', title: '–§–∞—Å–∞–¥', order: 7 }
    };

    async function loadData() {
      const response = await fetch('data.json');
      DATA = await response.json();
      render();
    }

    function render() {
      renderStatsBar();
      renderAlerts();
      renderMatrix();
      updateBreadcrumb('main');
      document.getElementById('generated-date').textContent = new Date(DATA.meta.generated).toLocaleDateString('ru-RU');
    }

    function renderStatsBar() {
      const container = document.getElementById('stats-bar');
      const total = DATA.meta.totalTechnologies;
      const approved = DATA.directions.reduce((sum, d) => sum + d.stats.byStatus.approved, 0);
      const review = DATA.directions.reduce((sum, d) => sum + d.stats.byStatus.review, 0);
      const draft = DATA.directions.reduce((sum, d) => sum + d.stats.byStatus.draft, 0);
      const pct = total > 0 ? Math.round((approved / total) * 100) : 0;

      container.innerHTML = `
        <div class="stats-bar-title">üèóÔ∏è –í–®–†</div>
        <div class="stats-bar-items">
          <div class="stats-item">
            <div class="stats-item-value">${DATA.meta.totalDirections}</div>
            <div class="stats-item-label">–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π</div>
          </div>
          <div class="stats-item">
            <div class="stats-item-value">${approved}</div>
            <div class="stats-item-label">–≥–æ—Ç–æ–≤–æ</div>
          </div>
          <div class="stats-item">
            <div class="stats-item-value">${review}</div>
            <div class="stats-item-label">–ø—Ä–æ–≤–µ—Ä–∫–∞</div>
          </div>
          <div class="stats-item">
            <div class="stats-item-value">${draft}</div>
            <div class="stats-item-label">—á–µ—Ä–Ω–æ–≤–∏–∫</div>
          </div>
        </div>
        <div class="stats-progress">
          <div class="stats-progress-bar">
            <div class="stats-progress-fill" style="width: ${pct}%"></div>
          </div>
          <div class="stats-progress-label">${pct}%</div>
        </div>
      `;
    }

    function renderAlerts() {
      const container = document.getElementById('alerts');
      const problemDirs = DATA.directions.filter(d => {
        const pct = d.stats.total > 0 ? (d.stats.byStatus.approved / d.stats.total) : 0;
        return pct === 0 && d.stats.total > 0;
      });

      if (problemDirs.length === 0) {
        container.innerHTML = '';
        return;
      }

      container.innerHTML = problemDirs.slice(0, 3).map(d => `
        <div class="alert">
          <span class="alert-icon">‚ö†Ô∏è</span>
          <span class="alert-text"><strong>${DIRECTION_ICONS[d.id]} ${d.name}</strong> ‚Äî 0% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (${d.stats.total} —Ç–µ—Ö–Ω.)</span>
          <span class="alert-link" onclick="showDirection('${d.id}')">–ü–µ—Ä–µ–π—Ç–∏ ‚Üí</span>
        </div>
      `).join('');
    }

    function renderMatrix() {
      const container = document.getElementById('matrix-container');
      const noResults = document.getElementById('no-results');

      const filteredDirs = DATA.directions.filter(d => {
        if (currentFilter === '—á–µ—Ä–Ω–æ–≤–∞—è' && !d.stages.includes('—á–µ—Ä–Ω–æ–≤–∞—è')) return false;
        if (currentFilter === '—á–∏—Å—Ç–æ–≤–∞—è' && !d.stages.includes('—á–∏—Å—Ç–æ–≤–∞—è')) return false;
        if (currentStatusFilter !== 'all') {
          const hasStatus = d.technologies.some(t => t.status === currentStatusFilter);
          if (!hasStatus) return false;
        }
        if (searchQuery) {
          const q = searchQuery.toLowerCase();
          const nameMatch = d.name.toLowerCase().includes(q);
          const techMatch = d.technologies.some(t => t.name.toLowerCase().includes(q) || t.id.toLowerCase().includes(q));
          return nameMatch || techMatch;
        }
        return true;
      });

      if (filteredDirs.length === 0) {
        container.innerHTML = '';
        noResults.style.display = 'block';
        return;
      }
      noResults.style.display = 'none';

      const chernovayaDirs = filteredDirs.filter(d => d.stages.includes('—á–µ—Ä–Ω–æ–≤–∞—è'));
      const chistovayaDirs = filteredDirs.filter(d => d.stages.includes('—á–∏—Å—Ç–æ–≤–∞—è'));

      const chernovayaBlocks = {};
      chernovayaDirs.forEach(d => {
        if (!chernovayaBlocks[d.block]) chernovayaBlocks[d.block] = [];
        if (!chernovayaBlocks[d.block].find(x => x.id === d.id)) chernovayaBlocks[d.block].push(d);
      });

      const chistovayaBlocks = {};
      chistovayaDirs.forEach(d => {
        if (!chistovayaBlocks[d.block]) chistovayaBlocks[d.block] = [];
        if (!chistovayaBlocks[d.block].find(x => x.id === d.id)) chistovayaBlocks[d.block].push(d);
      });

      const chernovayaTotal = chernovayaDirs.reduce((sum, d) => sum + d.stats.total, 0);
      const chistovayaTotal = chistovayaDirs.reduce((sum, d) => sum + d.stats.total, 0);

      container.innerHTML = `
        <div class="matrix-column">
          <div class="matrix-header —á–µ—Ä–Ω–æ–≤–∞—è">
            <span class="matrix-header-icon">üî®</span>
            <span class="matrix-header-title">–ß–µ—Ä–Ω–æ–≤–æ–π —ç—Ç–∞–ø</span>
            <span class="matrix-header-count">${Object.keys(chernovayaBlocks).length} –±–ª–æ–∫–æ–≤ ¬∑ ${chernovayaTotal} —Ç–µ—Ö–Ω.</span>
          </div>
          <div class="matrix-blocks">${renderBlockCards(chernovayaBlocks)}</div>
        </div>
        <div class="matrix-column">
          <div class="matrix-header —á–∏—Å—Ç–æ–≤–∞—è">
            <span class="matrix-header-icon">‚ú®</span>
            <span class="matrix-header-title">–ß–∏—Å—Ç–æ–≤–æ–π —ç—Ç–∞–ø</span>
            <span class="matrix-header-count">${Object.keys(chistovayaBlocks).length} –±–ª–æ–∫–æ–≤ ¬∑ ${chistovayaTotal} —Ç–µ—Ö–Ω.</span>
          </div>
          <div class="matrix-blocks">${renderBlockCards(chistovayaBlocks)}</div>
        </div>
      `;
    }

    function renderBlockCards(blockGroups) {
      const sortedBlocks = Object.entries(blockGroups).sort((a, b) => {
        return (BLOCK_INFO[a[0]]?.order || 99) - (BLOCK_INFO[b[0]]?.order || 99);
      });

      return sortedBlocks.map(([block, dirs]) => {
        const info = BLOCK_INFO[block] || { icon: 'üìÅ', title: block };
        const blockClass = BLOCK_CLASSES[block] || '';
        const totalTech = dirs.reduce((sum, d) => sum + d.stats.total, 0);
        const approvedTech = dirs.reduce((sum, d) => sum + d.stats.byStatus.approved, 0);
        const pct = totalTech > 0 ? Math.round((approvedTech / totalTech) * 100) : 0;

        return `
          <div class="block-card ${blockClass}" onclick="toggleBlockCard(this, event)">
            <div class="block-card-header">
              <span class="block-card-icon">${info.icon}</span>
              <span class="block-card-title">${info.title}</span>
              <div class="block-card-stats">
                <div class="block-progress"><div class="block-progress-fill" style="width: ${pct}%"></div></div>
                <span class="block-card-count">${dirs.length}</span>
                <span class="block-card-toggle">‚ñº</span>
              </div>
            </div>
            <div class="block-card-content">
              ${dirs.map(d => renderDirectionRow(d)).join('')}
            </div>
          </div>
        `;
      }).join('');
    }

    function renderDirectionRow(d) {
      const icon = DIRECTION_ICONS[d.id] || 'üìÅ';
      const pct = d.stats.total > 0 ? Math.round((d.stats.byStatus.approved / d.stats.total) * 100) : 0;

      return `
        <div class="direction-row" onclick="event.stopPropagation(); showDirection('${d.id}')">
          <span class="row-icon">${icon}</span>
          <span class="row-id">${d.id}</span>
          <span class="row-name">${d.name}</span>
          <div class="row-progress">
            <div class="progress-bar-mini"><div class="fill" style="width: ${pct}%"></div></div>
          </div>
          <span class="row-tech-count"><strong>${d.stats.byStatus.approved}</strong>/${d.stats.total}</span>
        </div>
      `;
    }

    function toggleBlockCard(card, event) {
      if (event.target.closest('.direction-row')) return;
      card.classList.toggle('collapsed');
    }

    function setFilter(filter) {
      currentFilter = filter;
      document.querySelectorAll('.filter-tab').forEach(t => t.classList.toggle('active', t.dataset.filter === filter));
      renderMatrix();
    }

    function setStatusFilter(status) {
      currentStatusFilter = status;
      document.querySelectorAll('.status-btn').forEach(b => b.classList.toggle('active', b.dataset.status === status));
      renderMatrix();
    }

    function updateBreadcrumb(view, data = {}) {
      const breadcrumb = document.getElementById('nav-breadcrumb');
      if (view === 'main') {
        breadcrumb.innerHTML = `<span class="nav-crumb active">–ì–ª–∞–≤–Ω–∞—è</span>`;
      } else if (view === 'direction') {
        const dir = DATA.directions.find(d => d.id === data.directionId);
        const icon = DIRECTION_ICONS[data.directionId] || 'üìÅ';
        breadcrumb.innerHTML = `
          <span class="nav-crumb" onclick="showMainView()">–ì–ª–∞–≤–Ω–∞—è</span>
          <span class="nav-crumb-sep">‚Ä∫</span>
          <span class="nav-crumb active">${icon} ${dir?.name || data.directionId}</span>
        `;
      } else if (view === 'technology') {
        const result = findTechnology(data.techId);
        if (result) {
          const { tech, direction } = result;
          const icon = DIRECTION_ICONS[direction.id] || 'üìÅ';
          breadcrumb.innerHTML = `
            <span class="nav-crumb" onclick="showMainView()">–ì–ª–∞–≤–Ω–∞—è</span>
            <span class="nav-crumb-sep">‚Ä∫</span>
            <span class="nav-crumb" onclick="showDirection('${direction.id}')">${icon} ${direction.name}</span>
            <span class="nav-crumb-sep">‚Ä∫</span>
            <span class="nav-crumb active">${tech.id}</span>
          `;
        }
      }
    }

    function showDirection(id) {
      const direction = DATA.directions.find(d => d.id === id);
      if (!direction) return;

      document.getElementById('main-view').style.display = 'none';
      document.getElementById('direction-view').classList.add('active');
      document.getElementById('tech-view').classList.remove('active');
      updateBreadcrumb('direction', { directionId: id });
      window.scrollTo(0, 0);

      const content = document.getElementById('direction-content');
      const blockClass = BLOCK_CLASSES[direction.block] || '';
      const icon = DIRECTION_ICONS[direction.id] || 'üìÅ';

      const chernovye = direction.technologies.filter(t => t.stage === '—á–µ—Ä–Ω–æ–≤–∞—è');
      const chistovye = direction.technologies.filter(t => t.stage === '—á–∏—Å—Ç–æ–≤–∞—è');

      content.innerHTML = `
        <div class="direction-header ${blockClass}">
          <div class="direction-icon">${icon}</div>
          <span style="font-family: monospace; font-size: 11px; color: var(--text-muted); background: var(--bg-hover); padding: 3px 8px; border-radius: 4px;">${direction.id}</span>
          <h1 class="direction-title">${direction.name}</h1>
          <div class="direction-meta">
            <span>üìÑ ${direction.stats.total} —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</span>
            <span>üì¶ ${direction.block}</span>
            ${direction.stages.map(s => `<span class="stage-badge ${s}">${s}</span>`).join(' ')}
          </div>
          <div class="direction-deps">
            ${direction.requires.length > 0 ? `
              <div class="dep-group">
                <h4>‚¨ÖÔ∏è –¢—Ä–µ–±—É–µ—Ç</h4>
                <div class="dep-tags">
                  ${direction.requires.map(r => {
                    const dep = DATA.directions.find(d => d.id === r);
                    return `<div class="dep-tag requires" onclick="showDirection('${r}')">${DIRECTION_ICONS[r] || 'üìÅ'} ${r} ${dep ? dep.name : ''}</div>`;
                  }).join('')}
                </div>
              </div>
            ` : ''}
            ${direction.opens.length > 0 ? `
              <div class="dep-group">
                <h4>‚û°Ô∏è –û—Ç–∫—Ä—ã–≤–∞–µ—Ç</h4>
                <div class="dep-tags">
                  ${direction.opens.map(o => {
                    const dep = DATA.directions.find(d => d.id === o);
                    return `<div class="dep-tag opens" onclick="showDirection('${o}')">${DIRECTION_ICONS[o] || 'üìÅ'} ${o} ${dep ? dep.name : ''}</div>`;
                  }).join('')}
                </div>
              </div>
            ` : ''}
          </div>
        </div>

        ${chernovye.length > 0 ? `
          <div class="stage-section">
            <h3 class="stage-title —á–µ—Ä–Ω–æ–≤–∞—è">üî® –ß–µ—Ä–Ω–æ–≤–æ–π —ç—Ç–∞–ø <span class="count">${chernovye.length}</span></h3>
            <div class="tech-list">${chernovye.map(t => renderTechItem(t)).join('')}</div>
          </div>
        ` : ''}

        ${chistovye.length > 0 ? `
          <div class="stage-section">
            <h3 class="stage-title —á–∏—Å—Ç–æ–≤–∞—è">‚ú® –ß–∏—Å—Ç–æ–≤–æ–π —ç—Ç–∞–ø <span class="count">${chistovye.length}</span></h3>
            <div class="tech-list">${chistovye.map(t => renderTechItem(t)).join('')}</div>
          </div>
        ` : ''}
      `;
    }

    function renderTechItem(tech) {
      const dots = Array(5).fill(0).map((_, i) => `<span class="${i < tech.difficulty ? 'filled' : ''}"></span>`).join('');
      return `
        <div class="tech-item" onclick="showTechnology('${tech.id}')">
          <span class="tech-id">${tech.id}</span>
          <span class="tech-name">${tech.name}</span>
          <div class="tech-meta">
            <div class="tech-difficulty" title="–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${tech.difficulty}/5">${dots}</div>
            <span class="tech-status ${tech.status}">${tech.status}</span>
          </div>
        </div>
      `;
    }

    let previousView = 'main';
    let previousDirectionId = null;

    function findTechnology(techId) {
      for (const dir of DATA.directions) {
        const tech = dir.technologies.find(t => t.id === techId);
        if (tech) return { tech, direction: dir };
      }
      return null;
    }

    function showTechnology(techId) {
      const result = findTechnology(techId);
      if (!result) return;

      const { tech, direction } = result;
      const icon = DIRECTION_ICONS[direction.id] || 'üìÅ';
      const blockClass = BLOCK_CLASSES[direction.block] || '';

      if (document.getElementById('direction-view').classList.contains('active')) {
        previousView = 'direction';
        previousDirectionId = direction.id;
      } else {
        previousView = 'main';
      }

      document.getElementById('main-view').style.display = 'none';
      document.getElementById('direction-view').classList.remove('active');
      document.getElementById('tech-view').classList.add('active');
      updateBreadcrumb('technology', { techId });
      window.scrollTo(0, 0);

      const backBtn = document.getElementById('tech-back-btn');
      backBtn.textContent = previousView === 'direction' ? `‚Üê ${direction.name}` : '‚Üê –í—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è';
      backBtn.onclick = () => {
        if (previousView === 'direction' && previousDirectionId) showDirection(previousDirectionId);
        else showMainView();
      };

      const sections = tech.sections || [];
      const tocCard = document.getElementById('tech-toc').parentElement;

      if (sections.length > 3) {
        tocCard.style.display = 'block';
        const tocIcons = {
          '–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å': '‚úÖ', '–ö–æ–≥–¥–∞ –ù–ï –ø—Ä–∏–º–µ–Ω—è—Ç—å': '‚ùå',
          '–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞': 'üëç', '–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏': 'üëé',
          '–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã': 'üì¶', '–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã': 'üîß',
          '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞': 'üìã', '–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è': 'üìù',
          '–ß–µ–∫-–ª–∏—Å—Ç –∫–∞—á–µ—Å—Ç–≤–∞': '‚úÖ', '–ü—Ä–∏—ë–º–∫–∞ —Ä–∞–±–æ—Ç—ã': 'üéØ',
          '–¢–µ—Ö–Ω–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏': '‚ö†Ô∏è', '–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã': '‚ùì'
        };
        document.getElementById('tech-toc').innerHTML = sections.map(s => {
          const sIcon = tocIcons[s] || 'üìÑ';
          const id = s.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]/g, '');
          return `<li><a href="#${id}" onclick="scrollToSection('${id}')">${sIcon} ${s}</a></li>`;
        }).join('');
      } else {
        tocCard.style.display = 'none';
      }

      document.getElementById('tech-header-container').innerHTML = `
        <div class="tech-header ${blockClass}">
          <div class="tech-breadcrumb">
            <a href="#" onclick="showMainView(); return false;">–ì–ª–∞–≤–Ω–∞—è</a>
            <span>‚Ä∫</span>
            <a href="#" onclick="showDirection('${direction.id}'); return false;">${icon} ${direction.name}</a>
            <span>‚Ä∫</span>
            <span>${tech.id}</span>
          </div>
          <div class="tech-title-row">
            <div class="tech-icon">${icon}</div>
            <div class="tech-title-content">
              <h1 class="tech-title">${tech.name}</h1>
              <p class="tech-description">${tech.description || ''}</p>
            </div>
          </div>
          <div class="tech-badges">
            <span class="tech-badge stage ${tech.stage}">${tech.stage}</span>
            <span class="tech-badge">üìä ${tech.difficulty}/5</span>
            <span class="tech-badge">‚è±Ô∏è ${tech.timeToLearn || '‚Äî'}</span>
            <span class="tech-badge">${tech.process || ''}</span>
            <span class="tech-badge tech-status ${tech.status}">${tech.status}</span>
          </div>
        </div>
      `;

      if (typeof marked !== 'undefined') {
        let html = marked.parse(tech.content || '–ö–æ–Ω—Ç–µ–Ω—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');
        html = html.replace(/<h2>([^<]+)<\/h2>/g, (match, title) => {
          const id = title.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]/g, '');
          return `<h2 id="${id}">${title}</h2>`;
        });
        document.getElementById('tech-content').innerHTML = html;
      } else {
        document.getElementById('tech-content').innerHTML = `<pre>${tech.content || '–ö–æ–Ω—Ç–µ–Ω—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</pre>`;
      }
    }

    function scrollToSection(id) {
      const el = document.getElementById(id);
      if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function showMainView() {
      document.getElementById('main-view').style.display = 'block';
      document.getElementById('direction-view').classList.remove('active');
      document.getElementById('tech-view').classList.remove('active');
      updateBreadcrumb('main');
      window.scrollTo(0, 0);
    }

    document.getElementById('search').addEventListener('input', (e) => {
      searchQuery = e.target.value;
      renderMatrix();
    });

    loadData();
  </script>
</body>
</html>
