# Виртуальная Школа Ремонта — Архитектура системы

## 1. Концепция

**Цель:** Стандартизация процессов ремонта → Обучение рабочих → Сертификация → Найм на реальные объекты

**Воронка:**
```
Вход (бесплатно) → Обучение → Тестирование → Очная приёмка → Сертификат → Пул рабочих
```

---

## 2. Иерархия сущностей (от общего к частному)

```
НАПРАВЛЕНИЕ (Direction)
    └── ЭТАП РЕМОНТА (Stage)
            └── ПРОЦЕСС (Process)
                    └── ТЕХНОЛОГИЯ (Technology)
                            └── ШАГ (Step)
                                    └── ЧЕК-ПОИНТ (Checkpoint)
```

### Примеры:

| Направление | Этап | Процесс | Технология | Шаг |
|-------------|------|---------|------------|-----|
| Электрика | Черновая | Прокладка кабеля | Штробление | 1. Разметка трассы |
| Электрика | Черновая | Прокладка кабеля | Штробление | 2. Выбор инструмента |
| Электрика | Черновая | Прокладка кабеля | Штробление | 3. Глубина штробы |
| Отделка | Чистовая | Покраска стены | Валиком | 1. Подготовка поверхности |
| Отделка | Чистовая | Покраска стены | Валиком | 2. Грунтовка |
| Сантехника | Черновая | Разводка труб | ППР сварка | 1. Расчёт диаметров |

---

## 3. Структура базы данных

### 3.1 Справочники (контент системы)

```sql
-- Направления работ
directions (
    id,
    name,           -- "Электрика", "Сантехника", "Отделка", "Монтаж"
    description,
    icon,
    sort_order
)

-- Этапы ремонта
stages (
    id,
    name,           -- "Демонтаж", "Черновая", "Чистовая"
    description,
    sort_order
)

-- Процессы (что делаем)
processes (
    id,
    direction_id,   -- FK → directions
    stage_id,       -- FK → stages
    name,           -- "Прокладка кабеля", "Покраска стены", "Установка розеток"
    description,
    difficulty,     -- 1-5 (сложность)
    estimated_time, -- примерное время освоения
    prerequisites   -- JSON: требуемые процессы перед этим
)

-- Технологии (как делаем)
technologies (
    id,
    process_id,     -- FK → processes
    name,           -- "Штробление", "В кабель-канале", "Валиком", "Краскопультом"
    description,
    when_to_use,    -- когда применять эту технологию
    pros,           -- преимущества
    cons,           -- недостатки
    materials,      -- JSON: список материалов
    tools           -- JSON: список инструментов
)

-- Шаги технологии (пошаговая инструкция)
steps (
    id,
    technology_id,  -- FK → technologies
    step_number,
    title,          -- "Разметка трассы"
    description,    -- подробное описание
    photo_url,      -- фото примера
    video_url,      -- опционально видео
    warnings,       -- на что обратить внимание
    common_errors,  -- типичные ошибки
    time_estimate   -- примерное время в минутах
)

-- Чек-поинты (контрольные точки для проверки)
checkpoints (
    id,
    step_id,        -- FK → steps
    technology_id,  -- FK → technologies (для общих чек-поинтов технологии)
    checkpoint_type,-- "step" | "technology" | "process"
    title,          -- "Глубина штробы 25мм"
    description,
    check_method,   -- как проверить
    photo_example,  -- фото правильного результата
    is_critical     -- критичный ли (нельзя продолжать без выполнения)
)
```

### 3.2 Пользователи и прогресс

```sql
-- Пользователи (рабочие)
users (
    id,
    telegram_id,
    phone,
    full_name,
    email,
    avatar_url,
    registration_date,
    status,         -- "learning" | "testing" | "certified" | "active" | "blocked"
    experience_years,
    specializations -- JSON: основные направления
)

-- Прогресс обучения
user_progress (
    id,
    user_id,
    technology_id,
    status,         -- "not_started" | "in_progress" | "completed" | "certified"
    started_at,
    completed_at,
    score           -- баллы за тест
)

-- Пройденные шаги
user_steps (
    id,
    user_id,
    step_id,
    completed_at,
    time_spent      -- сколько времени потратил
)

-- Результаты тестов
test_results (
    id,
    user_id,
    technology_id,
    attempt_number,
    score,
    passed,
    answers,        -- JSON: ответы пользователя
    taken_at
)
```

### 3.3 Тестирование

```sql
-- Вопросы для тестов
questions (
    id,
    technology_id,  -- FK → technologies
    step_id,        -- FK → steps (опционально, для вопроса по конкретному шагу)
    question_type,  -- "single" | "multiple" | "photo" | "sequence"
    question_text,
    photo_url,      -- фото к вопросу
    options,        -- JSON: варианты ответов
    correct_answer, -- JSON: правильный ответ(ы)
    explanation,    -- объяснение правильного ответа
    difficulty,     -- 1-3
    points          -- баллы за вопрос
)

-- Тесты (наборы вопросов)
tests (
    id,
    technology_id,
    name,
    description,
    questions_count,
    time_limit,     -- в минутах
    passing_score,  -- проходной балл в %
    max_attempts
)
```

### 3.4 Геймификация

```sql
-- Достижения (значки)
achievements (
    id,
    name,           -- "Электрик-новичок", "Мастер штукатурки"
    description,
    icon_url,
    condition_type, -- "technologies_completed" | "tests_passed" | "score_total"
    condition_value,-- JSON: условие получения
    points
)

-- Достижения пользователей
user_achievements (
    id,
    user_id,
    achievement_id,
    earned_at
)

-- Уровни
levels (
    id,
    name,           -- "Ученик", "Подмастерье", "Мастер", "Эксперт"
    min_points,
    icon_url,
    perks           -- JSON: бонусы уровня
)

-- Сертификаты
certificates (
    id,
    user_id,
    direction_id,   -- по какому направлению
    level,          -- "basic" | "advanced" | "expert"
    issued_at,
    expires_at,
    examiner_id,    -- кто принял очный экзамен
    certificate_number,
    pdf_url
)
```

### 3.5 Найм и объекты (будущее)

```sql
-- Объекты (для будущего найма)
projects (
    id,
    name,
    address,
    status,
    required_skills -- JSON: какие технологии нужны
)

-- Назначения рабочих
assignments (
    id,
    project_id,
    user_id,
    role,
    status,
    rating          -- оценка работы
)
```

---

## 4. Логика прогрессии

### 4.1 Путь рабочего

```
1. РЕГИСТРАЦИЯ
   └── Заполняет профиль (опыт, специализации)
   └── Выбирает направление(я) для обучения

2. ОБУЧЕНИЕ (по каждой технологии)
   └── Читает теорию (шаги)
   └── Смотрит фото/видео
   └── Отмечает чек-поинты "понял"
   └── Получает баллы за прогресс

3. ТЕСТИРОВАНИЕ
   └── Проходит тест по технологии
   └── 80%+ → технология освоена
   └── <80% → повторное изучение

4. СЕРТИФИКАЦИЯ НАПРАВЛЕНИЯ
   └── Все технологии направления пройдены
   └── Итоговый тест по направлению
   └── Очная приёмка (демонстрация навыков)
   └── Получает сертификат

5. ПУЛ РАБОЧИХ
   └── Доступен для назначения на объекты
   └── Рейтинг растёт от выполненных работ
```

### 4.2 Система баллов

| Действие | Баллы |
|----------|-------|
| Изучен шаг | 5 |
| Пройден чек-поинт | 10 |
| Тест технологии (80-89%) | 50 |
| Тест технологии (90-100%) | 100 |
| Очная сертификация | 500 |
| Первый проект без замечаний | 200 |

### 4.3 Уровни

| Уровень | Баллы | Статус |
|---------|-------|--------|
| Ученик | 0-500 | Обучение |
| Подмастерье | 501-2000 | Может ассистировать |
| Мастер | 2001-5000 | Самостоятельная работа |
| Эксперт | 5001+ | Может обучать других |

---

## 5. MVP — Минимальный продукт

### Фаза 1: Telegram-бот + Notion/Airtable
- Регистрация через бот
- Контент в Notion (инструкции, фото)
- Простые тесты в боте
- Ручная выдача сертификатов

### Фаза 2: Веб-платформа
- Личный кабинет
- Интерактивные инструкции
- Автоматические тесты
- Дашборд прогресса

### Фаза 3: Полная система
- Мобильное приложение
- Видео-контент
- Система найма
- Рейтинги и отзывы

---

## 6. Структура контента для заполнения

### Опросник для каждой технологии:

```yaml
Технология:
  Название: ""
  К какому процессу относится: ""
  К какому этапу относится: ""
  Направление: ""

  Когда применять: ""
  Преимущества: ""
  Недостатки: ""

  Необходимые материалы:
    - материал 1
    - материал 2

  Необходимые инструменты:
    - инструмент 1
    - инструмент 2

  Шаги выполнения:
    - Шаг 1:
        Название: ""
        Описание: ""
        Фото: ""
        Предупреждения: ""
        Типичные ошибки: ""
        Время: "" минут

        Чек-поинты:
          - "Проверить что..."
          - "Убедиться что..."

    - Шаг 2:
        ...

  Итоговые чек-поинты качества:
    - "Результат должен..."
    - "Не допускается..."

  Вопросы для теста:
    - Вопрос: ""
      Варианты: []
      Правильный: ""
      Объяснение: ""
```

---

## 7. Следующие шаги

1. **Утвердить структуру** — согласовать иерархию и сущности
2. **Создать справочники** — заполнить направления, этапы, процессы
3. **Детализировать 1 направление** — например, полностью расписать "Электрика"
4. **Прототип интерфейса** — как будет выглядеть обучение
5. **Выбрать технологии** — Telegram Bot API, база данных, хостинг

---

## 8. Вопросы для уточнения

1. Сколько примерно технологий в каждом направлении?
2. Какие направления в приоритете (электрика, сантехника, отделка, монтаж)?
3. Очная приёмка — по каждой технологии или по направлению целиком?
4. Срок действия сертификата (бессрочно или обновлять)?
5. Будет ли разделение по уровням внутри направления (базовый/продвинутый)?
